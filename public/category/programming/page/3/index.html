<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Programming | RETRO.MOE</title>
<meta name="keywords" content="">
<meta name="description" content="From Commodore 64 to the present: a developer&#39;s journey">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/category/programming/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fcb3718b9739f6b39cc36096f68dccc8a7e0d3e24fc6b09c575e0c25ec8f35b2.css" integrity="sha256-/LNxi5c59rOcw2CW9o3MyKfg0&#43;JPxrCcV14MJeyPNbI=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/category/programming/feed.xml">
<link rel="alternate" hreflang="en" href="http://localhost:1313/category/programming/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend&display=swap" rel="stylesheet">

</head>

<body class="list" id="top">
<script>
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="RETRO.MOE (Alt + H)">RETRO.MOE</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/unijoysticle/" title="Unijoysticle™">
                    <span>Unijoysticle™</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/unijoysticle2/" title="Unijoysticle™ 2">
                    <span>Unijoysticle™ 2</span>
                </a>
            </li>
            <li>
                <a href="https://www.tindie.com/stores/riq/" title="Store">
                    <span>Store</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="🔍">
                    <span>🔍</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/category/">Category</a></div>
  <h1>
    Programming
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">The Uni Games - Part II. Reboot
    </h2>
  </header>
  <div class="entry-content">
    <p>A reboot was needed. I rewrote most of the code. The game is no longer called “The Muni Race”. Instead it is called “The Uni Games” since it will have more than one event (think of “Summer Games” but for unicycles. UNICON basically).
The game will have a more-retro look and feel than before. It will only use PETSCII chars, plus sprites. No redefined characters, no bitmaps. Pure PETSCII. Pure retro effects.
</p>
  </div>
  <footer class="entry-footer"><span title='2016-03-27 15:46:20 +0000 +0000'>March 27, 2016</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to The Uni Games - Part II. Reboot" href="http://localhost:1313/2016/03/27/the-uni-games-part-ii-reboot/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">VChar64 v0.0.12 released
    </h2>
  </header>
  <div class="entry-content">
    <p>New version, new features.
Download Mac: vchar64-0.0.12.dmg.zip Win32: vchar64-0.0.12.win32.zip Changes [NEW] Koala Import: supports importing subregions. Useful when 256 chars are not enough to import the whole bitmap [NEW] Added unknown font. Ripped from here [NEW] VICE snapshot import: Default charset address is the one that was used at the moment the snapshot was taken [NEW] Save/Export: Plays one beep on success, two beeps on error [NEW] Main Window: Status Bar shows the coordinates of the different widgets [BUGFIX] Export: shows correct extension when browsing file [BUGFIX] VICE/Koala Import: sets the name of the imported file in the tab [BUGFIX] Koala Import: detects duplicates chars, making the conversion smaller </p>
  </div>
  <footer class="entry-footer"><span title='2016-03-02 07:16:41 +0000 +0000'>March 2, 2016</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to VChar64 v0.0.12 released" href="http://localhost:1313/2016/03/01/vchar64-v0-0-12-released/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">VChar64 v0.0.11 released
    </h2>
  </header>
  <div class="entry-content">
    <p>VChar64 v0.0.11 was released.
Win32: vchar64-0.0.11.win32.zip Mac: vchar64-0.0.11.dmg.zip Source code: github It includes several bug fixes and some important new features like:
Koala import support Map support Export to Assembly Full Changelog here.
</p>
  </div>
  <footer class="entry-footer"><span title='2016-02-01 08:40:35 +0000 +0000'>February 1, 2016</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to VChar64 v0.0.11 released" href="http://localhost:1313/2016/02/01/vchar64-v0-0-11-released/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Disassembling 6502 code with Radare - Part II
    </h2>
  </header>
  <div class="entry-content">
    <p>Let’s crack a simple game. If you are not familiar with Radare, read Part I first.
Creating and opening a VICE Snapshot file Let’s crack BC’s Quest For Tires since its copy-protection is easy to bypass.
Unzip this file: http://tapes.c64.no/tapes/BCsQuestForTires.zip
Open the tap file with VICE (the most popular Commodore 64 emulator), and..
…the game has some kind of copy-protection. If we enter invalid codes, we won’t be able to play the game.
Since Radare supports VICE Snapshot File format, we can save an snapshot of the game, and analyze it with Radare.
In VICE, go to the menu, Snapshot -&gt; Save Snapshot Image… If we select “Save ROMs”, then the BASIC ROM and the KERNAL ROM will be saved inside the Snapshot file, and will be included as Radare sections. Radare VICE Snapshot File (VSF) support lets us inspect:
The 64k RAM of the computer at the moment the snapshot was saved The BASIC and KERNAL ROMs in case they were saved. To open a VSF file, just pass the VSF file as the first argument:
$ r2 bc_copy_protection_screen.vsf [0x00005689]&gt; 0x00005689 is the PC (program counter) at the moment the snapshot was saved.
</p>
  </div>
  <footer class="entry-footer"><span title='2015-12-10 02:54:47 +0000 +0000'>December 10, 2015</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Disassembling 6502 code with Radare - Part II" href="http://localhost:1313/2015/12/09/disassembling-6502-core-with-radare-part-ii/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Disassembling 6502 code with Radare - Part I
    </h2>
  </header>
  <div class="entry-content">
    <p>Radare is an open source portable reversing framework that can do many things, among those things it can disassemble 6502 code.
Download and install radare First, download radare from github. You need a recent version in order to disassemble 6502 code. And then install it by running sys/install.sh (or sys/user.sh for local installation): $ git clone https://github.com/radare/radare2.git $ cd radare2 $ ./sys/install.sh Loading a c64 .prg Radare has many command line options. But in order to load 6502 programs we need just two:
-a6502 to specify the 6502 architecture. -mMemoryAddress to map the file to a certain memory address. Use 2047 for “normal” programs. Usually they start at $0801 (2049), but we have to subtract 2 from the .prg header. Example:
$ r2 -a6502 -m2047 mygame.prg Disassembling Radare doesn’t have a GUI, like IDA. Instead is has a powerful command line interface (think of GDB). Example:
$ r2 -a6502 -m2047 musicplayer.prg [0x000007ff]&gt; And 0x7ff (2047) is the seek address, meaning that all commands will use that address as the base address. Let’s print the first 32 bytes. ( px = print hexa):
[0x000007ff]&gt; px 32 offset 0 1 2 3 4 5 6 7 8 9 A B C D E F 0123456789ABCDEF 0x07ff 0108 0b08 3905 9e32 3036 3100 0000 78ad ....9..2061...x. 0x080f 0ddc a212 a000 b9d4 1a99 f020 c8d0 f7ce ........... .... The “2061” that we see, is part of the BASIC “SYS 2061” command that usually appears in all C64 programs. So, let’s disassemble the first 12 instructions from 2061. ( pd = print disassemble):
[0x000007ff]&gt; pd 12 @ 2061 0x0000080d 78 sei 0x0000080e ad0ddc lda 0xdc0d 0x00000811 a212 ldx #0x12 0x00000813 a000 ldy #0x00 ┌┌─&gt; 0x00000815 b9d41a lda 0x1ad4,y ││ 0x00000818 99f020 sta 0x20f0,y ││ 0x0000081b c8 iny └──&lt; 0x0000081c d0f7 bne 0xf7 │ 0x0000081e ce1708 dec 0x0817 │ 0x00000821 ce1a08 dec 0x081a │ 0x00000824 ca dex └─&lt; 0x00000825 d0ee bne 0xee In case we don’t know the meaning of a certain opcode, we can print its description with ?d:
[0x00000815]&gt; ?d sei set interrupt disable status Or if we want to print the description in every disassembled line, we can do:
e asm.describe=true And then disassemble again:
[0x0000080e]&gt; pd 12 @2061 0x080d 78 sei ; set interrupt disable status 0x080e ad0ddc lda 0xdc0d ; load accumulator with memory 0x0811 a212 ldx #0x12 ; load index x with memory 0x0813 a000 ldy #0x00 ; load index y with memory ┌─&gt; 0x0815 b9d41a lda 0x1ad4,y ; load accumulator with memory │ 0x0818 99f020 sta 0x20f0,y ; store accumulator in memory │ 0x081b c8 iny ; increment index y by one └─&lt; 0x081c d0f7 bne 0xf7 ; branch on result not zero 0x081e ce1708 dec 0x0817 ; decrement memory by one 0x0821 ce1a08 dec 0x081a ; decrement memory by one 0x0824 ca dex ; decrement index x by one 0x0825 d0ee bne 0xee ; branch on result not zero For more disassembling options just type p?
</p>
  </div>
  <footer class="entry-footer"><span title='2015-11-19 06:52:23 +0000 +0000'>November 19, 2015</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Disassembling 6502 code with Radare - Part I" href="http://localhost:1313/2015/11/18/disassembling-6502-code-with-radare-part-i/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Impressions of Google I/O 2015
    </h2>
  </header>
  <div class="entry-content">
    <p>What was interesting about the Keynote:
Brillo: the OS for the IoT… but but but, there were no talks about it, almost no information about it, nothing. Android Studio with C&#43;&#43; support: Finally :) The NDK really needs love, and having an IDE that supports it is great. Hey, even Microsoft is supporting the NDK now in VS2015. Photos is decoupled from Google&#43; with free unlimited storage: This is great. I’ve been using Picasa since day one and I never used Google&#43; to store my photos. So basically Photos is the same as Picasa, but with unlimited storage. Offline maps: Yeah Chrome Custom Tabs: Interesting alternative to present 3rd party views with the benefits of both the web and native worlds. What was not-that-interesting about the Keynote:
The rest. I don’t care if Android has better permissions or not (yeah, the old permissions-model sucked, but I don’t find that news interesting). The Family section for Google Play is good, but not interesting. Android Pay, meh. etc.
One thing that I liked, but was not announced on the Keynote, was Project Jacquard. They are using conductive threads and other stuff to create “smart” cloths. Something that Adafruit and Sparkfun have been doing for a while, BTW.
</p>
  </div>
  <footer class="entry-footer"><span title='2015-05-30 04:42:44 +0000 +0000'>May 30, 2015</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Impressions of Google I/O 2015" href="http://localhost:1313/2015/05/29/impressions-of-google-io-2015/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Soldering, what could go wrong?
    </h2>
  </header>
  <div class="entry-content">
    <p>I’m good at software engineering, but in electronics, I’m a newbie. Nonetheless, I find electronics fascinating.
Last year I did the first basic tutorials with Arduino, then I played a little bit with Raspberry Pi and CI20 (technically not really electronics). And this year, I built a very simple circuit to connect the RGBI output of my Commodore 128 to VGA… I have been using breadboard, so no soldering, no PCB, or anything like that.
...</p>
  </div>
  <footer class="entry-footer"><span title='2015-04-12 05:03:26 +0000 +0000'>April 12, 2015</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Soldering, what could go wrong?" href="http://localhost:1313/2015/04/11/soldering-what-could-go-wrong/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Merging my unicycling and development blogs
    </h2>
  </header>
  <div class="entry-content">
    <p>Who has time to maintain two personal blogs ? It is even difficult to maintain just one. So what I did was to merge my unicycle ( monociclo.com.ar) blog into this one ( towp8.com).
I divided them in categories:
The unicycle blog is using the &#34; unicycle&#34; category. This blog is using the &#34; programming&#34; category </p>
  </div>
  <footer class="entry-footer"><span title='2015-04-10 01:10:56 +0000 +0000'>April 10, 2015</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Merging my unicycling and development blogs" href="http://localhost:1313/2015/04/09/merging-my-unicycling-and-development-blogs/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Switching from iOS to Android: My experience
    </h2>
  </header>
  <div class="entry-content">
    <p>For the past 5 or 6 years, I used iPhones as my default phones. But a few months ago I decided to switch to Android.
I tried Android devices before, but never as my default phone. At the beginning I started using a Samsung Galaxy S4 (a 2013 5&#34; device), but later I switch to a Xiaomi MI4 (a 2014 5&#34; device with better specs).
Without further ado, this is my feedback:
Launcher In case you don’t know what the launcher is, think of the shell that allows you to launch the applications. It is the first thing that appears when you turn on the phone. In a way, it defines the UX.
Each phone maker customize the Android launcher according to its needs. And you can also download 3rd party launchers. This is both a good thing and a bad thing.
The bad thing is that every phone maker have a different launcher, making it difficult to switch to other Android devices, since the UX is different. Google has its own launcher called Google Now Launcher, and tries hard to make sure that Android makers don’t differ too much from it, although that is not always true. Samsung, as an example, ships its phones with a launcher called TouchWiz. It doesn’t differ that much from Google Now Launcher, but its changes make it a worse phone, not a better one. Xiaomi, on the other hand, ships its phones with a completely different launcher which makes your Android device behave like an iOS device.
The good thing is that you can use a different launcher if you don’t like the default one (or create your own). This as a good thing because everything that can be configured, changed or replaced is an opportunity for innovation (see below).
</p>
  </div>
  <footer class="entry-footer"><span title='2014-12-25 01:37:57 +0000 +0000'>December 25, 2014</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Switching from iOS to Android: My experience" href="http://localhost:1313/2014/12/24/switching-from-ios-to-android-my-experience/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Integrating LiquidFun with Cocos2d-x: Part II
    </h2>
  </header>
  <div class="entry-content">
    <p>In Part I I described to how integrated LiquidFun with Cocos2d-x. In this part (part II) I’ll describe how to render the particles using a basic water effect.
Part I uses just one glDrawArrays(GL_POINTS, 0, total); to draw the particles. And although that works to draw “particles”, it is not enough to draw “water”.
Drawing “water” requires a more complex rendering algorithm, like the one used in this example. And implementing an algorithm similar that one is what this article describes.
The algorithm works more or less like this:
Choose a white circle and blur it. You can blur the circle at runtime Or you can blur it off-line. Create an a new frame-buffer (think of a clean off-screen buffer where you can render whatever you want) Render the particles into the newly created frame-buffer using the blurred circle Now render the frame-buffer into the main color-buffer using a threshold. The threshold could be something like this: If pixel.r &lt; 0.1, discard the pixel (the pixel won’t be drawn) If pixel.r &lt; 0.2, draw a blue pixel (for the border, although this is optional) else draw a white pixel (the inner part of the water) How to do it using Cocos2d-x and LiquidFun Let’s take the LFParticleSystemNode from Part I, and “evolve” it:
The first thing to do is to add the “off-screen” frame-buffer into the LFParticleSystemNode class. In Cocos2d-x, the “off-screen” buffers are created with the RenderTexture class. Example:
[code language=“cpp”] bool LFParticleSystemNode::init(b2ParticleSystem* particleSystem, float ratio) { … // create an off-screen frame-buffer with the size of the screen auto s = Director::getInstance()-&gt;getWinSize(); _renderTexture = cocos2d::RenderTexture::create(s.width, s.height, Texture2D::PixelFormat::RGBA8888); this-&gt;addChild(_renderTexture); _renderTexture-&gt;setAnchorPoint(Point::ANCHOR_MIDDLE); _renderTexture-&gt;setPosition(Point(s.width/2, s.height/2));
// Change the default shader. Use a the threshold shader auto program = GLProgram::createWithByteArrays(_renderTextureShaderVert, _renderTextureShaderFrag); auto programState = GLProgramState::getOrCreateWithGLProgram(program); programState-&gt;setUniformFloat(“u_threshold_discard”, 0.15); programState-&gt;setUniformFloat(“u_threshold_border”, 0.3);
… } [/code]
And, as mentioned earlier, the RenderTexture (the off-screen frame-buffer) needs a shader with a threshold. The threshold shader should look like the following:
[code language=“cpp”] varying vec4 v_fragmentColor; varying vec2 v_texCoord; uniform float u_threshold_discard; uniform float u_threshold_border;
void main() { vec4 color = v_fragmentColor * texture2D(CC_Texture0, v_texCoord); if( color.r &lt; u_threshold_discard) // black or discard color = vec4(0,0,0,0); else if( color.r &lt; u_threshold_border) // blue for the border color = vec4(0.2,0.2,0.9,1); else // white for the center color = vec4(1,1,1,1); gl_FragColor = color; } [/code]
The values u_threshold_discard, and u_threshold_border are defined at runtime. In the example, they are set at 0.15 and 0.3 respectively.
The next thing to do is, to render the particles in the RenderTexture.
[code language=“cpp”]void LFParticleSystemNode::draw(Renderer *renderer, const Mat4 &amp;transform, uint32_t transformFlags) { // tell RenderTexture to “capture” the particles _renderTexture-&gt;beginWithClear(0,0,0,0);
_customCommand.init(_globalZOrder); _customCommand.func = CC_CALLBACK_0(LFParticleSystemNode::onDraw, this, transform, transformFlags); renderer-&gt;addCommand(&amp;_customCommand);
// tell RenderTexture to stop “capturing” the particles _renderTexture-&gt;end(); } [/code]
The result is the following </p>
  </div>
  <footer class="entry-footer"><span title='2014-07-30 20:45:00 +0000 +0000'>July 30, 2014</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;ricardoquesada</footer>
  <a class="entry-link" aria-label="post link to Integrating LiquidFun with Cocos2d-x: Part II" href="http://localhost:1313/2014/07/30/integrating-liquidfun-with-cocos2d-x-part-ii/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="http://localhost:1313/category/programming/page/2/">
      «&nbsp;Prev&nbsp;
    </a>
    <a class="next" href="http://localhost:1313/category/programming/page/4/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
</body>

</html>

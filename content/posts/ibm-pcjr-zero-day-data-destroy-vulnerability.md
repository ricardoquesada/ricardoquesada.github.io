---
author: ricardoquesada
category: retro computing
date: "2018-01-15T19:44:37+00:00"
guid: http://retro.moe/?p=2074
summary: |-
  IBM PCjr zero-day data-destroy vulnerability (AKA: Joykill).
tag:
  - ibm pcjr
  - vulnerability
  - zero day
title: 'IBM PCjr: Zero-day Data-destroy vulnerability'
url: /2018/01/15/ibm-pcjr-zero-day-data-destroy-vulnerability/

---
{{< figure align=alignnone width=512 src="https://lh3.googleusercontent.com/K-NgekCgCRi74dY-7MQYeVi1tlvJSHet7XOU0D7gmiV%5FZrkEyLE3KNgk1kuNRvFUSptnAnIrDVAiC2IgwdDir-dWgcToKrI0T35i9hWPP2lD5a88gRqzsgEmvDmbwRuo76Jr4c629xY=-no" alt="" >}}

IBM PCjr zero-day data-destroy vulnerability (AKA: Joykill).

**Description:**

This vulnerability allows local and remote attackers to destroy the contents of the floppy diskette. User interaction is required to exploit this vulnerability. The issue results from the lack of proper validation when starting the manufacturing system test.

**Exploit (local):**

{{< youtube Zbv9DJ_nXo0 >}}

1. Plug the two joysticks into the IBM PCjr
1. Insert diskette in floppy drive (data will get destroyed!)
1. Press Ctrl + Alt + Ins. to enter into diagnostics mode
1. Immediately after, press:
   1. Joystick 1 button B
   1. Joystick 2 buttons A + B
1. Diskette data will get destroyed

**Exploit (remote):**

[![](https://lh3.googleusercontent.com/_0Ng2HeU7MdrNpzk1HIjNljYoq89FIPNgqbL2qYhpQq4tn2fCmEKadAh5Te_QKeSSQwBzVw1WVzoFy7leCL1ZOdnWJNcAe8DvMcTgJ4YAArqRNBuybDQln6qOWeUa0euqsub2xZGu9qgGWeoKO27OvJRghOY4-5jiylGurSaNw64IMo6qOPVXiml7jciR8beES8AWm0SsC_BqduncCRTR0DckSLFSFtA7ToO1dZmXZI0dlwlPqAHutrgFCXo4FwveYY7vnHev1NZdZbd53o1b718lqOKTHNCYmgF1Jy_Bu0rCKjYEv-FvfxWMxrPPdaqHBbBxEib0zcuRZAvkrTPLlg-15jsUD9QgDH092sI9ihuFiYU5Px94_e89onE2taqH4J9IOwagK5H5FyETJ1YLEpnXHxsRoQ7WY6hxN1uTZBi6MZA7U6oVN-m4RyQgEmV5WHRan-abd3PBxk0kg5npIjzFMx-_mvf64SOnaHefkW_jEdFrwPAxzuzWkXim9ducVRxcDJjuA7Z5l8cn28IBu_ITwo3Ma2nEhO4B0i5_fop67IdTET1b5rODf46r52ywi59p16oohMyXxvL22bJEHlKS6rL4aGKTJhW9bvMXsqQPMlChLzIKaAxmuIAz8zZv5uYwoa_D03xW5-qt7aHMPLoRrheK6VqEg=-no)](https://lh3.googleusercontent.com/JtfeFPgsgDBY-uy0n03QdNdX9RX4bXa1wOhgWNs__9aQKTfYxOxpFKkjPV6j1FSHwqzfUNV1gjhLE_SxhVe-9xHtxjXlgcgdFZVvIAYOGtgGIwHtp4oRJt1tAlRKHcjjE_TuUMRDAR2O931H_TjRRGrrrEfHisyjPX70i6TQuOfFy76bdMrV-eE5w8hFY2ZOp7jg1Aj8jkR-RYx5SgFAJMBaAPZhLFkpuX2zf3WLFc2gaifo-5BUNvaEaALnERjWAi9cMlKhQ9so0I3CimtQOe_gdzHYMUH0CHGajhOPaGLOIJEiEmtqrPB7zjKinCKaxk5zc9P9qXEl6d3GU-rD0qnUZebumZfagbKK6VCM-va3Ya6PDFS1FzT-bBqHcmOH6uiifTsIVEAhYfOs-zBhxQgHNkSJRHVf2_ANoeFDOsJ-J740K1TQOuZER_pqmaFM_6iKibdav1RNaXxeuvgP9-gaXJCFsBisbu92FM8fkPPnDeXB3PfVz98_Q1QDvVdPBt7k0ljRvS5XXeKpdqwNFMTIstmcnU8A0HcSAP6Eof0WL5k5AjB8YCdOqQ-aKJ9s6xB74R5C0sNFVree7d6m-m9MRdqQrWqgHZtFUb0xHVpZC_IeDcWL3MtBemMIiU4UTmXyL-NqKYrBoXyyUyzkIjfIb_LA5v6A5A=w1468-h1552-no)

*A step-by-step of how to remotely exploit the vulnerability.*

1. Build two IBM PCjr joysticks with 50-meter long cables
1. Ship them to the target user with a letter saying:

> Dear customer,
>
> As a token of our gratitude, we are sending you these two joysticks that will let you do an online backup of your most valued diskettes.
>
> Please, plug them in your PCjr, and leave the controllers outside your house. Call us at our support call-center {insert your phone number} once you are ready for the online backup.
>
> Don't forget to insert your most valued diskette in the floppy drive!
>
> Yours,
>
> IBM PCjr tech support.

1. Wait until the user places the two joysticks outside his house and wait for his call. Once he/she calls you, press the joysticks buttons described above and respond with:

> Thank you for calling IBM PCjr online backup service.
>
> Please, press Ctrl+Alt+Ins in your PCjr to initiate the online backup service.

Ka-boom! The user data will get destroyed!

**Responsibility disclosure:**

- Retro Moe called 1-800-222-PCjr multiple times. The person on the other end of the line seems to know nothing about the IBM PCjr computer. In fact, it seems that he/she knows nothing about IBM.

{{< figure align=alignnone width=511 src="https://lh3.googleusercontent.com/ctq7c5dJ9Zv0GkMP57CZ2iIZ7Lmkn7iBgm-0rK8bnNfOX-VtKLLxgtrdbURi23ZX2m-X5mi6Jnb-sN93MsVO7cv97AZFJsxdCVkk6DRHngJ4NEyW-EEvGIi6Loyu%5FL6FEzjea83bKPtXP2DgM-0eaKTI9jP7NxFT3wIj23ZntDUTRRf8kMYoxnDM3cciuB4ZVYNtxarq0B1x%5Fh9kpkaL56W4D6xaE4prd86kQ85FPrSEjRTVULQVVSIkYuYzmeEdqjVkXnO0I4sXWT1VLsG9A1XcuVoaYv31U1Zr4TggYDl8rnNKr9GD34WdoABa7Ru51COve9VnV5JXe0tiEso0RnIvl-LIaBPxZe53rjo2PhgncFRL6B4yLIYyjZ0dCIkRQiO1fF8SBQEz26IDzCnLjVOIVU833IM-JDh3GvpQ3kwPB0tZJ3WfRYEsjG6KrlTx3bu%5FOUwzguAHyRGBfEshpI2EeED2BOGb7UmaVbuldt4BTVUg8ZgYcV9Jhjj39Y7f%5FtWFD0OcgBcwo-KLU3bbsJ59t62748JFK6fLLjf40EXpuXPBaTufw%5Fdyzr8CPisyFFiUX9-p2frPE1MbfDQ8vMewvByE4HKLlPUIbcIb2z8WRDJJZRkXMDSQos9fW6F9yqAwmGRvunXka1bRK8gixZPUA50a2XbE%5FQ=-no" alt="" >}}

**Technical description:**

IBM PCjr contains built-in diagnostics code in the ROM. This diagnostics code has undocumented features to perform the manufacturing and service tests:

- Manufacturing burn-in mode: All 4 buttons pressed
- Manufacturing system-test mode: All 4 buttons pressed except Joystick 1 button A
- Service loop-post mode: All buttons pressed except Joystick 1 button B
- Service system-test mode: All buttons pressed except Joystick 2 button A

When entering in "Manufacturing system-test mode", all internal tests (diskette, video, joystick, sound, printer, modem) will be performed without user interaction. The first test, and without any warning, is the diskette test that will destroy the diskette data. Since there is no visual indication of what's happening, port 0x10 will have the test number that is being executed.

**Why IBM did this:**

Retro Moe strongly believes that IBM left the code undocumented on purpose to prevent people from performing their own in-depth diagnostics. That way IBM could charge you extra money for that.

Retro Moe knows that by disclosing this vulnerability many IBM PCjr Technical Support employees might lose their jobs (since they will no longer be needed). But Retro Moe also believes in Power to the people, and knowledge is power!

For more information, all the undocumented features, including a Joystick test performed with keyboards go:

- [IBM PCjr BIOS disassembled including the undocumented diagnostic code](https://github.com/ricardoquesada/bios-8088/tree/master/ibm_pcjr)
- [Diagnostic trigger tool](https://github.com/ricardoquesada/pc-8088-misc/tree/master/undiagjr)

**About:**

Retro Moe does stuff related to joysticks (like the [UniJoystiCle](/unijoysticle/) and this vulnerability) and some other stuff not related to joysticks at all.
